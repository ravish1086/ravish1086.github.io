<html>
    <head>
        <Title>Tasker Application</Title>
        <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="HandheldFriendly" content="true">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    </head>
    
        <h2>Tasker - Just For YOU  (Under Development) </h2>
        <body onload="GetDetails();">
            <h3 id="User"></h3>
        <div>
            <div>
                Aaj Ki Tareekh: <br><font id="tareekh"></font>
            </div>
            <br>
        <div><font>Enter the Task Name:</font> 
         <input type="text" name="taskname" id="taskname" class="form-control"> 
         <font>Enter Task Description :</font>
         <input type="text" name="description" id="description" class="form-control">
         <font>Target Date :</font>
         <input type="date" name="date" id="date" class="form-control">
        </div>
        <button onclick="AddTask();">Add Task</button>

        <table border="1px solid" id="tablee" class="table table-striped">
            <tr><th>TaskName</th><th>Description</th><th>Target Date</th><th>Created On</th></tr>
          
        </table>
        <button onclick="ClearStorage();">
clear storage
            </button>
        </button>
        </div>
        <script>
            function ClearStorage()
            {
                localStorage.clear();
            }
            function AddTask()
            {   
                var length=localStorage.length;
                console.log('length is = '+length);
                var date=new Date();
                length=length/4;
                console.log("In Add Task");
                var taskname=document.getElementById('taskname').value;
                var description=document.getElementById('description').value;
                var targetdate=document.getElementById('date').value;
                var createdon=date.toDateString();
                console.log(taskname);
                var keytaskname='taskname'+length;
                var keydescription='description'+length;
                var keytargetdate='targetdate'+length;
                var keycreatedon='createdon'+length;
                window.localStorage.setItem(keytaskname, taskname);
                window.localStorage.setItem(keydescription,description);
                window.localStorage.setItem(keytargetdate, targetdate);
                window.localStorage.setItem(keycreatedon,createdon);

                var lengthh=localStorage.length;
                console.log('after adding length is = '+lengthh);
                location.reload();
                
            }
            function GetDetails()
            {
                checkCookie();
                var date=new Date();
                console.log(date.toDateString());
                document.getElementById('tareekh').innerHTML=date.toDateString();
                var length=localStorage.length;
                console.log(length);
                document.getElementById('date').innerHTML=date.toDateString();
               for (i = 0; i < localStorage.length; i+=4)
                {
                    a=i/4;
                    console.log('a ='+a);
                    var row='<tr><td id="taskname'+a+'"></td><td id="description'+a+'"></td><td id="targetdate'+a+'"></td><td id="createdon'+a+'"></tr>';
                console.log(row);
                document.getElementById('tablee').innerHTML+=row;
                var taskname=window.localStorage.getItem('taskname'+a);
                console.log("In Details1"+ taskname);
                var description=window.localStorage.getItem('description'+a);
                console.log("In Details2"+ description);
                var targetdate=window.localStorage.getItem('targetdate'+a);
                console.log("In Details3"+ targetdate);
                var createdon=window.localStorage.getItem('createdon'+a);
                console.log("In Details4"+ createdon);
                document.getElementById('taskname'+a).innerHTML=taskname;
                document.getElementById('description'+a).innerHTML=description;
                document.getElementById('targetdate'+a).innerHTML=targetdate;
                document.getElementById('createdon'+a).innerHTML=createdon;

                b=a+1;
                console.log('value of b is ='+b);
                }
            }
//Copied Code from W3schools
            function setCookie(cname,cvalue,exdays) {
  var d = new Date();
  d.setTime(d.getTime() + (exdays*24*60*60*1000));
  var expires = "expires=" + d.toGMTString();
  document.cookie = cname + "=" + cvalue + ";" + expires + ";";
}

function getCookie(cname) {
  var name = cname + "=";
  var decodedCookie = decodeURIComponent(document.cookie);
  var ca = decodedCookie.split(';');
  for(var i = 0; i < ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}

function checkCookie() {
  var user=getCookie("username1");
  if (user != "") {
   // alert("Welcome again " + user);
  } else {
     //user = prompt("Please enter your name:","");
     user="User";
     if (user != "" && user != null) {
       setCookie("username1", user, 30);
       document.getElementById("User").innerHTML='Welcome '+user;
     }
  }
}
        </script>
        </body>
        </html>